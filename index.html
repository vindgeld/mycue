<!DOCTYPE html>
<html lang="en">
   <head>
      <title>kolsotCam</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <link rel="icon" type="image/x-icon" href="1.jpg">
      <style>
       					:root{--bgclr:#021526;--txtclr:silver;--lst:#1E3E62;--actfrme:yellow;}
         .dark{--bgclr:black;--txtclr:white;--lst:#333;--actfrme:maroon;}
         body {font-family:sans-serif;color:var(--txtclr);margin:0;padding:0;background:var(--bgclr);transition: background-color 0.3s, color 0.3s;}
        
        header {padding-left:1em;height:8vh;background:var(--lst);color:var(--txtclr);display:flex;justify-content:space-between;align-items:center;}
         .isi,.tog{position:fixed;right:0}
         .isi{z-index:500;top:8vh;display:flex;flex-direction:column;font-size:1rem;overflow:hidden;background-color:transparent;transform:scaleX(0);transition:.3s ease-in-out;}
         .tog{background:transparent;}
         .tog:hover ~ .isi {transform:scaleX(1);}
          .isi button {margin:0.1em;outline: none;cursor: pointer;border: none;padding: 0.1rem 0.6rem;
         											position: relative;display: inline-block;letter-spacing: 0.05rem;
         											font-weight: 700;font-size: 1.2em;border-radius: 500px;border: 1px solid #0070d2;
         											overflow: hidden;background:var(--lst);color: var(--txtclr);}
         .dashboard{position:relative;max-width:100vw;}
         .project-list, .segment-list {list-style: none;padding: 0;}
         .namaproj {text-align: center;flex-grow: 1;}
   														.project-page {display:flex;flex-direction:column;}
         .project-list li {display:flex;justify-content: space-between;align-items: center;padding: 10px;
      																		margin:0.5rem;outline: none;cursor: pointer;border: none;letter-spacing: 0.05rem;
         											font-weight: 700;font-size: 1.2em;border-radius: 50px;overflow: hidden;background:var(--lst);color:var(--txtclr)}
         .project-list button {display: inline-block;outline: 0;border: 0;cursor: pointer;
         											background: #1a3452;color:maroon;border-radius: 8px;padding: 5px 10px 5px;
         											font-size: 0.8em;font-weight: 700;line-height: 1;}
         .hidden {display: none;}
   	.listnya.full{z-index:2;height:80vh;margin-top:1vh;scroll-snap-type: y mandatory;overflow: auto;scroll-behavior: smooth;background:transparent;overflow-y:auto;}
   .listnya{z-index:2;height:55vh;margin-top:1vh;scroll-snap-type: y mandatory;overflow: auto;scroll-behavior: smooth;background:transparent;overflow-y:auto;}
         .segment-list li {color:var(--txtclr);scroll-snap-type: y mandatory;overflow: auto;scroll-behavior: smooth;padding: 1vh;margin: 0 2vw;
            				border:none;border-radius: 4px;cursor: pointer;}
         .segment-list li.active {background:var(--actfrme)/*#8E1616*/;font-weight: bold;}
         .segment-list li button {display:inline-block;margin:0;outline: none; cursor: pointer; padding: 0 6px;
         													background-color:var(--lst);border-radius: 0.25rem; border: 1px solid #0070d2;
         													color:var(--txtclr);font-size: 13px;line-height: 30px;font-weight: 400;text-align: center;
         													:hover {background-color: #005fb2;  border-color: #005fb2;}}
         .segment-list div {display:flex;justify-content:space-between;border-radius: 5px;}
      										.actbtn {display: grid;}            											
          .timernya{background:transparent;}
          .edts, .dels{height:5vh;}
         .backbtn button, .addsave button{margin:5px 10px 0 5px;outline: none; cursor: pointer; padding: 0 6px;
         													background-color:var(--lst);border-radius: 0.25rem; border: 1px solid #0070d2;
         													color:var(--txtclr);font-size: 13px;line-height: 30px;font-weight: 400;text-align: center;
         													:hover {background-color: #005fb2;  border-color: #005fb2;} }
      				  .btntimer {display:flex;justify-content: space-between;align-items: center;}			/*top:50%;transform:translateY(-50%);*/
          .controlbtn {position:fixed;right:15px;bottom:55px;margin: auto;display:flex;flex-direction:column;align-items: flex-end;z-index:5;gap:3px;}
          /*.bottom-buttons{display: flex;flex-wrap: wrap;width: 100%;}*/
   											  .ouopenseg{position:fixed;right:15px;bottom:20px;margin: auto;flex-wrap:wrap;display:flex;flex-direction:wrap;z-index:5;justify-content:center;gap:3px;}					
   										   .controlbtn button, .ouopenseg button{outline: none; cursor: pointer; padding: 0 7px;
         													background-color:var(--lst);border-radius: 0.25rem; border: 1px solid #0070d2;
         													color: var(--txtclr);font-size: 13px;line-height: 30px;font-weight: 400;text-align: center;
         													:hover {background-color: #005fb2;  border-color: #005fb2;} }	
   														.project-title{color:var(--txtclr);margin:5px 5px 1vh 5vw;font-size:1.5em;line-height: 30px;font-weight: 700;}
      							.modal {z-index:3;width:70vw;height:60vh;position: fixed;top: 50%;left: 50%;transform: translate(-50%, -50%);background:#1E3E62;padding: 10px;border-radius: 10px;box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);}
         .modal.hidden {display: none;}
         .modal input {margin-bottom: 1px;padding: 1px;width: 100%;}
         .modal button {margin-top: 5px;background-color: #4a90e2;color: white;padding: 5px 10px;border: none;border-radius: 5px;cursor: pointer;}
   														#total-time{margin:1vh 0 0 5vw;position:fixed;bottom:0;background:#021526;}
   														.dragging {opacity: 0.9;border: 12px dashed #ccc;}
   											.drag-over {background-color:yellow;}
    .mpc{width:96vw;margin: 0 auto;background:transparent;padding:0;border-radius: 8px;}
      /*      											#player{width: 100%;aspect-ratio: 16/9;}
    .mpc input{margin:0;width:44vw;color:blue;padding:0.6rem;background:#bbc5cf;border-radius:10px}
    .mpc button{;margin:5px 10px 0 5px;outline: none; cursor: pointer; padding: 0 6px;
         													background-color:var(--bgclr);border-radius: 0.25rem; border: 1px solid #0070d2;
         													color:var(--txtclr);font-size: 13px;line-height: 30px;font-weight: 400;text-align: center;
         													:hover {background-color: #005fb2;  border-color: #005fb2;}}
    #playlist{height:15vh;background:var(--bgclr);overflow: auto;scroll-behavior: smooth;}#playlist-items{list-style-type: none;padding: 0;margin-top:0;}
    #playlist-items li{padding:2px;border: 1px solid #0070d2;background:var(--bgclr);margin-bottom:1px;color:var(--txtclr);font-size:0.8rem;border-radius: 5px;display: flex;justify-content: space-between;}
    #playlist-items li button{margin:5px 10px 0 5px;outline: none; cursor: pointer; padding: 0 6px;
         													background-color:var(--bgclr);border-radius: 0.25rem; border: 1px solid #0070d2;
         													color:var(--txtclr);font-size: 13px;line-height: 30px;font-weight: 400;text-align: center;
         													:hover {background-color: #005fb2;  border-color: #005fb2;}} */
	.inputfile {width: 0.1px;height: 0.1px;opacity: 0;overflow: hidden;position: absolute;z-index: -1;}
.inputfile:focus + label,.inputfile.has-focus + label,.inputfile + label:hover {color:silver;outline: 1px dotted #000;outline: -webkit-focus-ring-color auto 5px;}
.inputfile + label {background-color: #1E3E62;
color:silver;border: 1px solid #0070d2;padding:6px 14px;
font-size: 16px;
border-radius: 12px;
cursor: pointer;
}
   					#video, #youtubePlayer {position:sticky;top:0;width: 100%;max-height: 360px;border-radius: 8px;
background: #000;}
     #youtubeURL{margin:0;width:42vw;color:blue;padding:0.3rem;background:#bbc5cf;border-radius:10px}
    .controls {position:sticky;top:100px;display:flex;justify-content: center;align-items: center;gap: 20px;
background-color:transparent;
padding: 5px 8px;border-radius: 12px;margin-bottom: 2px;
}
    .time-inputs {display: flex;gap: 20px;align-items: center;background-color: #0f1b35;padding: 10px 20px;border-radius: 12px;}
    .time-block {display: flex;flex-direction: column;align-items: center;}
    .formatted-time {font-size: 16px;
color: #d0d0ff;
margin-bottom: 4px;
font-family: monospace;
}
    input[type="number"] {
width: 60px;
padding: 5px;
background-color: #16213e;
color: white;
border: none;
border-radius: 6px;
text-align: center;
}
    input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {opacity: 1;}
    button#loadYoutubeBtn {
background-color: #1E3E62;
color:silver;
border: 1px solid #0070d2;padding: 6px 14px;font-size: 16px;border-radius: 12px;cursor: pointer;}
    .play-btn {width:25px;display:flex;justify-content:space-between;background-color: #1E3E62;border: 1px solid #0070d2;padding: 12px 15px;font-size: 30px;border-radius: 12px;cursor: pointer;}
    button.play-btn:hover, button#loadYoutubeBtn:hover {background-color: #2c4b87;}
</style>
   </head>
   <body>
    <div id="dashboard" class="dashboard">
      <header>
         <h2>kolsote</h2>
         <div class="tog"><img src="icon.png" alt="" height="46px" width="50px"></div>
         <div class="isi">
            <button onclick="createProject()">Create New Project</button>
  																								<input type="file" id="file-input" accept=".xlsx" style="display: none" />
    																			<button onclick="triggerImport()">Import XLS</button>
            <button style="margin-bottom:20px" onclick="exportAllProjects()">Export XLS</button>
      														<button onclick="clearStorage()">Clear Cache</button>
         </div>
       </header>
      											
         <h2>소디엑 24ours</h2>
         <ul id="project-list" class="project-list"></ul>
      </div>
      
      <div id="segments-page" class="project-page hidden">
      											<div class="btn" style="display: flex;flex-direction: row;justify-content: space-between">
      																		<div class="backbtn" style="margin-left:2vw;display: flex;flex-direction: column;"><button style="padding: 5px 20px;" onclick="goToDashboard()">b  a  c  k</button></div>
         												<div class="addsave" style="display: flex;flex-direction:row;">
         			 <!--				<button onclick="showAddSegmentModal(activeSegmentIndex)">edit</button>
         			 													<button onclick="deleteSegment(activeSegmentIndex)">delete</button>-->
         																		<div id="project-title" class="project-title"></div>
         														</div>
      												</div>
         
         
<div id="mpc" class="mpc hidden">
    <div style="margin-bottom:10px;">
																<input type="file" id="videoInput" class="inputfile" accept="video/*" />
																<label for="videoInput"><span>filenya</span></label>
      <input type="text" id="youtubeURL" placeholder="Link YouTube" />
      <button id="loadYoutubeBtn">Load yutub</button>
    </div>
    <!-- Normal video tag -->
    <video id="video" controls></video>
    <!-- YouTube iframe placeholder -->
    <div id="youtubePlayer" class="hidden"></div>
    <div class="controls">
      <span class="play-btn" id="playBtn"><div style="height:20px;width:20px;background:red;clip-path: polygon(0 0, 0 100%, 100% 50%);"></div></span>
      <div class="time-inputs">
        <div class="time-block">
          <div id="startDisplay" class="formatted-time">00:00.0</div>
          <input type="number" id="startMin" min="0" value="0" step="1" />
          <input type="number" id="startSec" min="0" max="59.9" value="0" step="0.1" />
        </div>
        <div class="time-block">
          <div id="endDisplay" class="formatted-time">03:22.7</div>
          <input type="number" id="endMin" min="0" value="3" step="1" />
          <input type="number" id="endSec" min="0" max="59.9" value="22.7" step="0.1" />
        </div>
      </div>
    </div>
         											
         											<!--<div class="player" id="player"></div>
    <input type="text" id="youtube-link" placeholder="link yutub">
    <button id="add-to-playlist">Add</button>
    <div id="playlist"><ul id="playlist-items"></ul></div> -->
         											
</div>
   <div class="btntimer">     
        <div class="controlbtn">
         			<button style="height:7vh;width:7vh;background-color:maroon;" onclick="startTimer(activeSegmentIndex)">play</button>
         			<button style="height:7vh;width:7vh;background-color:maroon;" onclick="pauseTimer()">pause</button>
                 											<!--									<div class="bottom-buttons">8989
                 											</div>-->
        </div>
        <div class="ouopenseg">
    															<button onclick="toggleAutoplay()">Auto:<span id="autoToggle">ON</span></button>
																								<button id="toggleButton">openVid</button>
        					<button onclick="showAddSegmentModal()">addSeg</button>
         			<button style="width:7vh;padding: 0 3px;" onclick="stopTimer(activeSegmentIndex)">stop</button>
         			<button style="width:7vh;padding: 0 3px;" onclick="prevSegment()">prev</button>
         			<button style="width:7vh;padding: 0 3px;" onclick="nextSegment()">next</button>
        </div>
   </div>
      										<div id="listnya" class="listnya full"><ul id="segment-list" class="segment-list"></ul></div>
          <div id="total-time" style="z-index:4;font-weight: bold;"></div>
      </div>
      
      <div id="modal" class="modal hidden">
         <h3>Add/edit Segment</h3>
         <label for="segment-number">Number:</label><br>
         <input type="number" id="segment-number" placeholder="Enter number"><br>
         <label for="segment-title">Title:</label><br>
         <input type="text" id="segment-title" placeholder="Enter title"><br>
         <label for="segment-remarks">Remarks:</label><br>
         <textarea id="segment-remarks" rows="3" cols="32" placeholder="Enter remarks"></textarea><br>
         <label for="segment-duration">Duration (s):</label><br>
         <input type="number" id="segment-duration" placeholder="Enter duration in seconds"><br>
         <label for="segment-color">Color:</label><br>
         <input type="color" id="segment-color" value="#00ff00"><br><br>
         <button onclick="saveSegment()">Save Segment</button>
         <button class="close" onclick="closeModal()">Close</button>
      </div>
        <a id="linkol" style="z-index:4;position:fixed;bottom:0;left:0;background:var(--bgclr);color:var(--txtclr);text-decoration:none;" href="xodiac.xlsx">kolsot</a>
    <select id="tema" style="font-size:0.1px;z-index:4;position:fixed;bottom:0;right:0;background:var(--bgclr);color:var(--txtclr);border-radius:50px;" id="color-scheme-select">
    <option style="background:var(--bgclr)" value="default">`</option>
    <option value="dark">..</option>
  </select>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
      <script>
    const select = document.getElementById('color-scheme-select');
    select.addEventListener('change', function() {
      const selectedScheme = this.value;
      document.body.classList.remove('dark'); // Remove previous schemes
      if (selectedScheme !== 'default') {
        document.body.classList.add(selectedScheme); // Add the selected scheme
      }
    });
  </script>
           <script>
         let projects = JSON.parse(localStorage.getItem('projects')) || [];
         let currentProjectId = null;
         let activeSegmentIndex = 0;
         let intervalId = null;
																						let autoPlay = true;
         const timerEl = document.getElementById('total-time');
         
         function saveProjects() {
           localStorage.setItem('projects', JSON.stringify(projects));
         }
         
         function renderProjects() {
           const list = document.getElementById('project-list');
           list.innerHTML = '';
           projects.forEach(project => {
             const li = document.createElement('li');
             li.innerHTML = `<div class="namaproj">${project.name}</div>`;
             li.onclick = () => openProject(project.id);
             const del = document.createElement('button');
             del.textContent = 'del';
             del.onclick = e => {
               e.stopPropagation();
               deleteProject(project.id);
             };
             li.appendChild(del);
             list.appendChild(li);
           });
         }
         
         function createProject() {
           const name = prompt('Enter project name');
           if (!name) return;
           const id = Date.now();
           projects.push({ id, name, segments: [] });
           saveProjects();
           renderProjects();
         }
         
         function deleteProject(id) {
           if (confirm('Delete this project?')) {
             projects = projects.filter(p => p.id !== id);
             saveProjects();
             renderProjects();
           }
         }
         
         function openProject(id) {
           currentProjectId = id;
           activeSegmentIndex = 0;
           document.getElementById('dashboard').classList.add('hidden');
                  											document.getElementById('linkol').classList.add('hidden');
                  											document.getElementById('tema').classList.add('hidden');
           document.getElementById('segments-page').classList.remove('hidden');
           const project = projects.find(p => p.id === id);
           document.getElementById('project-title').textContent = project.name;
           renderSegments();
         }
         
   											
         function goToDashboard() {
           stopTimer();
           document.getElementById('dashboard').classList.remove('hidden');
           document.getElementById('segments-page').classList.add('hidden');
                  											document.getElementById('linkol').classList.remove('hidden');
           																												document.getElementById('tema').classList.remove('hidden');
           renderProjects();
         }
//  rubah renderseg tambah button editdelete start
function renderSegments() {
    const project = projects.find(p => p.id === currentProjectId);
    const list = document.getElementById('segment-list');
    list.innerHTML = '';
    let totalTime = 0;
    project.segments.forEach((s, i) => {
        const li = document.createElement('li');
        li.draggable = true;
        li.dataset.index = i;
        li.ondragstart = handleDragStart;
        li.ondragover = handleDragOver;
        li.ondrop = handleDrop;

        let buttonsHTML = '';
        if (i === activeSegmentIndex) {
            buttonsHTML = `
           													<div class="actbtn">
      																								   <div id="timernya" class="timernya"></div>
                   <div class="edts">		<button class="edit-button" data-index="${i}">Edit</button></div>
                							<div class="dels">	<button class="delete-button" data-index="${i}">Delete</button></div>
                </div>
            `;
        }

        li.innerHTML = `
            <div style="background:${s.color};padding:0.5rem">${s.number}. cam ${s.title} - ${s.duration}s<br>${s.remarks} ${buttonsHTML}</div>`;

        if (i === activeSegmentIndex) {
            li.classList.add('active');
            li.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        li.onclick = () => {
            activeSegmentIndex = i;
            li.scrollIntoView({ behavior: 'smooth', block: 'center' });
            stopTimer(); // Assuming you have a stopTimer() function
            renderSegments();
        };

        list.appendChild(li);
        totalTime += s.duration;
    });

    //  document.getElementById('total-time').textContent = `Total Time: ${totalTime} seconds`;
    const min = String(Math.floor(totalTime / 60)).padStart(2, '0');
    const sec = String(totalTime % 60).padStart(2, '0');
    timerEl.textContent = `Total time: ${min}:${sec}`;

    // Add event listeners for edit and delete buttons after rendering
    addEventListenersToButtons();
}

function addEventListenersToButtons() {
    document.querySelectorAll('.edit-button').forEach(button => {
        button.addEventListener('click', (event) => {
            const index = parseInt(event.target.dataset.index);
            showAddSegmentModal(index);
        });
    });

    document.querySelectorAll('.delete-button').forEach(button => {
        button.addEventListener('click', (event) => {
            const index = parseInt(event.target.dataset.index);
            deleteSegment(index); // Assuming you have a deleteSegment(index) function
        });
    });
}
            											// rubah renderseg end
            											
         // tambahan total time end
         
         //drag and drop start belum jadi
         function handleDragStart(e) {
            draggedIndex = e.currentTarget.dataset.index;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', draggedIndex);
            e.currentTarget.classList.add('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            document.querySelectorAll('#segment-list li').forEach(li => li.classList.remove('drag-over'));
            e.currentTarget.classList.add('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const droppedIndex = e.currentTarget.dataset.index;
            if (draggedIndex === null || droppedIndex === null || draggedIndex === droppedIndex) {
                return;
            }

            const project = projects.find(p => p.id === currentProjectId);

            const dragIndex = parseInt(draggedIndex, 10);
            const dropIndex = parseInt(droppedIndex, 10);

            const draggedItem = project.segments.splice(dragIndex, 1)[0];
            project.segments.splice(dropIndex, 0, draggedItem);

            saveProjects();
            renderSegments();
            draggedIndex = null;

            document.querySelectorAll('#segment-list li').forEach(li => li.classList.remove('dragging'));
            document.querySelectorAll('#segment-list li').forEach(li => li.classList.remove('drag-over'));
        }
         // drag and drop end
         
         
         
         
         function showAddSegmentModal(index = null) {
           const modal = document.getElementById('modal');
           modal.classList.remove('hidden');
           if (index !== null) {
             const s = projects.find(p => p.id === currentProjectId).segments[index];
             document.getElementById('segment-number').value = s.number;
             document.getElementById('segment-title').value = s.title;
             document.getElementById('segment-remarks').value = s.remarks;
             document.getElementById('segment-duration').value = s.duration;
             document.getElementById('segment-color').value = s.color;
             modal.dataset.editIndex = index;
           } else {
             modal.dataset.editIndex = '';
             document.getElementById('segment-number').value = '';
             document.getElementById('segment-title').value = '';
             document.getElementById('segment-remarks').value = '';
             document.getElementById('segment-duration').value = '';
             document.getElementById('segment-color').value = '#1E3E62';
           }
         }
         
         				function deleteSegment() {
         if (!confirm('Delete this segment?')) return;
         projects.find(p => p.id === currentProjectId).segments.splice(activeSegmentIndex, 1);
         saveProjects();
         renderSegments();
         }
         
         function closeModal() {
           document.getElementById('modal').classList.add('hidden');
         }
         
         function saveSegment() {
           const number = document.getElementById('segment-number').value;
           const title = document.getElementById('segment-title').value;
           const remarks = document.getElementById('segment-remarks').value;
           const duration = document.getElementById('segment-duration').value;
           const color = document.getElementById('segment-color').value;
           if (!number || !title || !duration || !color) return alert('isi semua, jangan dikosongin!');
           
           const project = projects.find(p => p.id === currentProjectId);
           const index = document.getElementById('modal').dataset.editIndex;
           const segment = { number, title, remarks, duration: parseInt(duration), color };
         
           if (index !== '') {
             project.segments[index] = segment;
           } else {
             project.segments.push(segment);
           }
         
           saveProjects();
           renderSegments();
           closeModal();
         }
         
         function startTimer() {
           if (intervalId) clearInterval(intervalId);
           const segment = projects.find(p => p.id === currentProjectId).segments[activeSegmentIndex];
           // Assuming each segment has a corresponding class name
    																const segmentElement = document.querySelector(`.active:nth-of-type(${activeSegmentIndex + 1})`); // Adjust the selector as needed

      // Scroll the segment into view
    if (segmentElement) {
        segmentElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

         											let remainingTime = segment.duration;
           const timerDisplay = document.getElementById('timernya');
           timerDisplay.innerHTML = `<span style="font-size:2rem;">${remainingTime}s</span>`;
           //document.body.appendChild(timerDisplay);
         
           intervalId = setInterval(() => {
             remainingTime--;
             timerDisplay.querySelector('span').textContent = `${remainingTime}s`;
         
             if (remainingTime <= 0) {
               clearInterval(intervalId);
               if (autoPlay) nextSegment();
             }
           }, 1000);
         }
         // added
   											
   											//adde 
         function stopTimer() {
           if (intervalId) clearInterval(intervalId);
         }
         				
         function pauseTimer() {
           clearInterval(intervalId);
           intervalId = null;
         }
         function nextSegment() {
           if (activeSegmentIndex < projects.find(p => p.id === currentProjectId).segments.length - 1) {
             activeSegmentIndex++;
             renderSegments();
           											if (autoPlay) startTimer();
           }
         }
         
         function prevSegment() {
           if (activeSegmentIndex > 0) {
             activeSegmentIndex--;
             renderSegments();
           											if (autoPlay) startTimer();
           }
         }
   											function toggleAutoplay() {
  autoPlay = !autoPlay;
  document.getElementById('autoToggle').textContent = autoPlay ? 'ON' : 'OFF';
}
         
   											
   											
   											
function triggerImport() {
  document.getElementById('file-input').click();
}
document.getElementById('file-input').addEventListener('change', handleImport);
 function handleImport(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function (e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    for (const sheetName of workbook.SheetNames) {
      const sheet = workbook.Sheets[sheetName];
      const rows = XLSX.utils.sheet_to_json(sheet);
      const segments = rows.map(row => ({
        number: row.number || '',
      					title: row.title || '',
        remarks: row.remarks || '',
        duration: Number(row.duration) || 0,
        color: row.color || '#00ff00'
      }));
      projects.push({
        id: Date.now() + Math.random(),
        name: sheetName,
        segments
      });
    }
    saveProjects();
    renderProjects();
  };
  reader.readAsArrayBuffer(file);
}

function exportAllProjects() {
  const workbook = XLSX.utils.book_new();
  for (const project of projects) {
    const data = project.segments.map((s, i) => ({
      number: i + 1,
      title: s.title,
      remarks: s.remarks,
      duration: s.duration,
      color: s.color
    }));
    const sheet = XLSX.utils.json_to_sheet(data);
    XLSX.utils.book_append_sheet(workbook, sheet, project.name);
  }
  XLSX.writeFile(workbook, 'kolsotan.xlsx');
}
  // export import xls end
    // clear localStorage start
   					function clearStorage() {
	localStorage.removeItem('projects');
	window.location.reload();
}
   				// clear localStorage end
   											
         
         renderProjects();
      </script>
            											
            											
<!--<script>var player,playlist=JSON.parse(localStorage.getItem("playlist"))||[];const apiKey="AIzaSyBpqAtBCDPMTIfvqA_5w6enWzuceVijFdU";function onYouTubeIframeAPIReady(){player=new YT.Player("player",{height:"100%",width:"100%",videoId:"bQN4aoknQg4",playerVars:{rel:0,modestbranding:1,playsinline:1},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}}),updatePlaylistDisplay()}function onPlayerReady(e){}function onPlayerStateChange(e){}function extractVideoId(e){const t=e.match(/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[2].length?t[2]:null}function addToPlaylist(e){fetchVideoTitle(e).then((t=>{t?(playlist.push({id:e,title:t}),savePlaylistToLocalStorage(),updatePlaylistDisplay()):alert("judul video ngga bisa di buka")}))}function fetchVideoTitle(e){return fetch(`https://www.googleapis.com/youtube/v3/videos?id=${e}&key=${apiKey}&part=snippet`).then((e=>e.json())).then((e=>e.items&&e.items.length>0?e.items[0].snippet.title:null)).catch((e=>(console.error("Error mbaca judul video:",e),null)))}function updatePlaylistDisplay(){const e=document.getElementById("playlist-items");e.innerHTML="",playlist.forEach(((t,a)=>{const l=document.createElement("li");l.textContent=t.title;const n=document.createElement("button");n.textContent="delete",n.onclick=function(){removeFromPlaylist(a)},l.appendChild(n),l.onclick=function(){player.loadVideoById(t.id)},e.appendChild(l)}))}function removeFromPlaylist(e){confirm("Serius mau dihapus?")&&(playlist.splice(e,1),savePlaylistToLocalStorage(),updatePlaylistDisplay())}function savePlaylistToLocalStorage(){localStorage.setItem("playlist",JSON.stringify(playlist))}document.getElementById("add-to-playlist").addEventListener("click",(function(){const e=extractVideoId(document.getElementById("youtube-link").value);e&&!playlist.some((t=>t.id===e))?(addToPlaylist(e),document.getElementById("youtube-link").value=""):alert("link youtube udah ada ato ga valid")}));</script>
 <script src="https://www.youtube.com/iframe_api"></script>
-->            											
<script>
   function toggleVideoVisibility() {
   const videoPlayer = document.getElementById('mpc');
   const listSeg = document.getElementById('listnya');
    if (videoPlayer.classList.contains('hidden') && listSeg.classList.contains('full'))	{
        videoPlayer.classList.remove('hidden');
        listSeg.classList.remove('full');        											
        // Optionally, change the button text or style here to indicate it's visible
        this.textContent = 'closeVid'; // Example: Change button text
    } else {
        videoPlayer.classList.add('hidden');
        listSeg.classList.add('full');     											
        // Optionally, change the button text or style here to indicate it's hidden
        this.textContent = 'openVid'; // Example: Change button text
    }
}
const toggleButton = document.getElementById('toggleButton');
toggleButton.addEventListener('click', toggleVideoVisibility);
</script> 
            											
            											
            											
  <script src="https://www.youtube.com/iframe_api"></script>

		<script>
'use strict';
;( function ( document, window, index )
{var inputs = document.querySelectorAll( '.inputfile' );
	Array.prototype.forEach.call( inputs, function( input )
	{var label	 = input.nextElementSibling,
			labelVal = label.innerHTML;
		input.addEventListener( 'change', function( e )
		{var fileName = '';
			if( this.files && this.files.length > 1 )
				fileName = ( this.getAttribute( 'data-multiple-caption' ) || '' ).replace( '{count}', this.files.length );
			else fileName = e.target.value.split( '\\' ).pop();
			if( fileName )
				label.querySelector( 'span' ).innerHTML = fileName;
			else label.innerHTML = labelVal; });
		// Firefox bug fix
		input.addEventListener( 'focus', function(){ input.classList.add( 'has-focus' ); });
		input.addEventListener( 'blur', function(){ input.classList.remove( 'has-focus' ); });
	});
}( document, window, 0 ));
		</script>
  <script>
    const video = document.getElementById('video');
    const youtubePlayerDiv = document.getElementById('youtubePlayer');
    const videoInput = document.getElementById('videoInput');
    const youtubeURLInput = document.getElementById('youtubeURL');
    const loadYoutubeBtn = document.getElementById('loadYoutubeBtn');
    const playBtn = document.getElementById('playBtn');

    const startMin = document.getElementById('startMin');
    const startSec = document.getElementById('startSec');
    const endMin = document.getElementById('endMin');
    const endSec = document.getElementById('endSec');
    const startDisplay = document.getElementById('startDisplay');
    const endDisplay = document.getElementById('endDisplay');

    let playing = false;
    let isYouTubeVideo = false;
    let youtubePlayer;

    // YouTube API ready callback
    function onYouTubeIframeAPIReady() {
      // Placeholder; player is created only when user loads a YouTube URL
    }

    // Extract YouTube video ID from URL
    function extractYouTubeID(url) {
      const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
      const match = url.match(regExp);
      return (match && match[2].length === 11) ? match[2] : null;
    }

    // Show only the normal video or YouTube player
    function showPlayer(type) {
      if (type === 'youtube') {
        video.classList.add('hidden');
        youtubePlayerDiv.classList.remove('hidden');
      } else {
        video.classList.remove('hidden');
        youtubePlayerDiv.classList.add('hidden');
      }
    }

    // Load local video file
    videoInput.addEventListener('change', () => {
      isYouTubeVideo = false;
      if (youtubePlayer) {
        youtubePlayer.stopVideo();
      }
      showPlayer('local');

      const file = videoInput.files[0];
      if (file) {
        const url = URL.createObjectURL(file);
        video.src = url;
        video.load();
        video.addEventListener('loadedmetadata', () => {
          setEndTime(Math.floor(video.duration));
          updateDisplay();
        }, { once: true });
      }
    });

    // Load YouTube video on button click
    loadYoutubeBtn.addEventListener('click', () => {
      const url = youtubeURLInput.value.trim();
      const videoId = extractYouTubeID(url);
      if (!videoId) {
        alert('Please enter a valid YouTube URL.');
        return;
      }
      isYouTubeVideo = true;
      showPlayer('youtube');
      

      if (youtubePlayer) {
        youtubePlayer.loadVideoById(videoId);
      } else {
        youtubePlayer = new YT.Player('youtubePlayer', {
          height: '360',
          width: '100%',
          videoId: videoId,
          playerVars: { 
            controls: 1,
            disablekb: 1,
            modestbranding: 1,
            rel: 0
          },
          events: {
            'onReady': onYouTubePlayerReady,
            'onStateChange': onYouTubePlayerStateChange
          }
        });
      }
      // Clear local video src
      video.src = '';
      updateDisplay();
youtubeURLInput.value="";
    });

    function onYouTubePlayerReady(event) {
      // Set default end time after video is ready
      const duration = youtubePlayer.getDuration();
      setEndTime(duration);
      updateDisplay();
    }

    function onYouTubePlayerStateChange(event) {
      if (event.data == YT.PlayerState.PLAYING) {
        playing = true;
      } else if (event.data == YT.PlayerState.PAUSED || event.data == YT.PlayerState.ENDED) {
        playing = false;
      }
    }

    function getStartTime() {
      return parseFloat(startMin.value) * 60 + parseFloat(startSec.value);
    }

    function getEndTime() {
      return parseFloat(endMin.value) * 60 + parseFloat(endSec.value);
    }

    // Clamp and sync inputs, update displays
    function updateDisplay() {
      let start = getStartTime();
      let end = getEndTime();

      if (start < 0) start = 0;
      if (end < 0) end = 0;

      if (start >= end) {
        if (document.activeElement === startMin || document.activeElement === startSec) {
          end = start + 0.1;
          setEndTime(end);
        } else {
          start = end - 0.1;
          if (start < 0) start = 0;
          setStartTime(start);
        }
      }

      startDisplay.textContent = formatTime(start);
      endDisplay.textContent = formatTime(end);
    }

    // Helper to set start inputs from seconds
    function setStartTime(seconds) {
      startMin.value = Math.floor(seconds / 60);
      startSec.value = (seconds % 60).toFixed(1);
    }

    // Helper to set end inputs from seconds
    function setEndTime(seconds) {
      endMin.value = Math.floor(seconds / 60);
      endSec.value = (seconds % 60).toFixed(1);
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = (seconds % 60).toFixed(1).padStart(4, '0');
      return `${String(mins).padStart(2, '0')}:${secs}`;
    }

    // Play/pause logic
    playBtn.addEventListener('click', () => {
      if (playing) {
        if (isYouTubeVideo && youtubePlayer) {
          youtubePlayer.pauseVideo();
        } else {
          video.pause();
        }
        playing = false;
       playBtn.innerHTML = '<div style="height:20px;width:20px;background:red;clip-path: polygon(0 0, 0 100%, 100% 50%);"></div>';
      } else {
        if (isYouTubeVideo && youtubePlayer) {
          youtubePlayer.seekTo(getStartTime(), true);
          youtubePlayer.playVideo();
        } else {
          video.currentTime = getStartTime();
          video.play();
        }
        playing = true;
       playBtn.innerHTML = '<div style="height:20px;width:10px;background:red;"></div><div style="height:20px;width:10px;background:red;"></div>';
      }
    });

    // Sync current time for local video
    video.addEventListener('timeupdate', () => {
      if (video.currentTime >= getEndTime()) {
        video.pause();
        playing = false;
      }
    });

    // Sync current time for YouTube video (polling because YouTube API doesn't provide fine-grained event)
    setInterval(() => {
      if (isYouTubeVideo && youtubePlayer && playing) {
        const currentTime = youtubePlayer.getCurrentTime();
        if (currentTime >= getEndTime()) {
          youtubePlayer.pauseVideo();
          playing = false;
        }
      }
    }, 200);

    // Update display on input changes
    [startMin, startSec, endMin, endSec].forEach(input => {
      input.addEventListener('input', updateDisplay);
    });

    // Initialize displays
    updateDisplay();
  </script>
            											
   </body>
</html>
